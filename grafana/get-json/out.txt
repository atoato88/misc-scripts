[
{"title":"CPU","expr":"sum(rate(container_cpu_usage_seconds_total{namespace=\"$deployment_namespace\",pod_name=~\"$deployment_name.*\"}[3m]))"},
{"title":"Memory","expr":"sum(container_memory_usage_bytes{namespace=\"$deployment_namespace\",pod_name=~\"$deployment_name.*\"}) / 1024^3"},
{"title":"Network","expr":"sum(rate(container_network_transmit_bytes_total{namespace=\"$deployment_namespace\",pod_name=~\"$deployment_name.*\"}[3m])) + sum(rate(container_network_receive_bytes_total{namespace=\"$deployment_namespace\",pod_name=~\"$deployment_name.*\"}[3m]))"},
{"title":"Desired Replicas","expr":"max(kube_deployment_spec_replicas{deployment=\"$deployment_name\",namespace=\"$deployment_namespace\"}) without (instance, pod)"},
{"title":"Available Replicas","expr":"min(kube_deployment_status_replicas_available{deployment=\"$deployment_name\",namespace=\"$deployment_namespace\"}) without (instance, pod)"},
{"title":"Observed Generation","expr":"max(kube_deployment_status_observed_generation{deployment=\"$deployment_name\",namespace=\"$deployment_namespace\"}) without (instance, pod)"},
{"title":"Metadata Generation","expr":"max(kube_deployment_metadata_generation{deployment=\"$deployment_name\",namespace=\"$deployment_namespace\"}) without (instance, pod)"},
{"title":"Replicas","expr":"max(kube_deployment_status_replicas{deployment=\"$deployment_name\",namespace=\"$deployment_namespace\"}) without (instance, pod)"},
{"title":"Replicas","expr":"min(kube_deployment_status_replicas_available{deployment=\"$deployment_name\",namespace=\"$deployment_namespace\"}) without (instance, pod)"},
{"title":"Replicas","expr":"max(kube_deployment_status_replicas_unavailable{deployment=\"$deployment_name\",namespace=\"$deployment_namespace\"}) without (instance, pod)"},
{"title":"Replicas","expr":"min(kube_deployment_status_replicas_updated{deployment=\"$deployment_name\",namespace=\"$deployment_namespace\"}) without (instance, pod)"},
{"title":"Replicas","expr":"max(kube_deployment_spec_replicas{deployment=\"$deployment_name\",namespace=\"$deployment_namespace\"}) without (instance, pod)"},
{"title":"Idle CPU","expr":"sum(rate(node_cpu{mode=\"idle\"}[2m])) * 100"},
{"title":"System Load","expr":"sum(node_load1)"},
{"title":"System Load","expr":"sum(node_load5)"},
{"title":"System Load","expr":"sum(node_load15)"},
{"title":"Memory Usage","expr":"sum(node_memory_MemTotal) - sum(node_memory_MemFree) - sum(node_memory_Buffers) - sum(node_memory_Cached)"},
{"title":"Memory Usage","expr":"sum(node_memory_Buffers)"},
{"title":"Memory Usage","expr":"sum(node_memory_Cached)"},
{"title":"Memory Usage","expr":"sum(node_memory_MemFree)"},
{"title":"Memory Usage","expr":"((sum(node_memory_MemTotal) - sum(node_memory_MemFree) - sum(node_memory_Buffers) - sum(node_memory_Cached)) / sum(node_memory_MemTotal)) * 100"},
{"title":"Disk I/O","expr":"sum(rate(node_disk_bytes_read[5m]))"},
{"title":"Disk I/O","expr":"sum(rate(node_disk_bytes_written[5m]))"},
{"title":"Disk I/O","expr":"sum(rate(node_disk_io_time_ms[5m]))"},
{"title":"Disk Space Usage","expr":"(sum(node_filesystem_size{device!=\"rootfs\"}) - sum(node_filesystem_free{device!=\"rootfs\"})) / sum(node_filesystem_size{device!=\"rootfs\"})"},
{"title":"Network Received","expr":"sum(rate(node_network_receive_bytes{device!~\"lo\"}[5m]))"},
{"title":"Network Transmitted","expr":"sum(rate(node_network_transmit_bytes{device!~\"lo\"}[5m]))"},
{"title":"Cluster Pod Utilization","expr":"sum(kube_pod_info)"},
{"title":"Cluster Pod Utilization","expr":"sum(kube_node_status_capacity_pods)"},
{"title":"Pod Utilization","expr":"100 - (sum(kube_node_status_capacity_pods) - sum(kube_pod_info)) / sum(kube_node_status_capacity_pods) * 100"},
{"title":"Control Plane Components Down","expr":"sum(up{job=~\"apiserver|kube-scheduler|kube-controller-manager\"} == 0)"},
{"title":"Alerts Firing","expr":"sum(ALERTS{alertstate=\"firing\",alertname!=\"DeadMansSwitch\"})"},
{"title":"Alerts Pending","expr":"sum(ALERTS{alertstate=\"pending\",alertname!=\"DeadMansSwitch\"})"},
{"title":"Crashlooping Pods","expr":"count(increase(kube_pod_container_status_restarts[1h]) > 5)"},
{"title":"Node Not Ready","expr":"sum(kube_node_status_condition{condition=\"Ready\",status!=\"true\"})"},
{"title":"Node Disk Pressure","expr":"sum(kube_node_status_condition{condition=\"DiskPressure\",status=\"true\"})"},
{"title":"Node Memory Pressure","expr":"sum(kube_node_status_condition{condition=\"MemoryPressure\",status=\"true\"})"},
{"title":"Nodes Unschedulable","expr":"sum(kube_node_spec_unschedulable)"},
{"title":"Control Plane UP","expr":"sum(up{job=~\"apiserver|kube-scheduler|kube-controller-manager\"} == 0)"},
{"title":"Alerts Firing","expr":"sum(ALERTS{alertstate=\"firing\",alertname!=\"DeadMansSwitch\"})"},
{"title":"API Servers UP","expr":"(sum(up{job=\"apiserver\"} == 1) / count(up{job=\"apiserver\"})) * 100"},
{"title":"Controller Managers UP","expr":"(sum(up{job=\"kube-controller-manager\"} == 1) / count(up{job=\"kube-controller-manager\"})) * 100"},
{"title":"Schedulers UP","expr":"(sum(up{job=\"kube-scheduler\"} == 1) / count(up{job=\"kube-scheduler\"})) * 100"},
{"title":"Crashlooping Control Plane Pods","expr":"count(increase(kube_pod_container_status_restarts{namespace=~\"kube-system|tectonic-system\"}[1h]) > 5)"},
{"title":"CPU Utilization","expr":"sum(100 - (avg by (instance) (rate(node_cpu{job=\"node-exporter\",mode=\"idle\"}[5m])) * 100)) / count(node_cpu{job=\"node-exporter\",mode=\"idle\"})"},
{"title":"Memory Utilization","expr":"((sum(node_memory_MemTotal) - sum(node_memory_MemFree) - sum(node_memory_Buffers) - sum(node_memory_Cached)) / sum(node_memory_MemTotal)) * 100"},
{"title":"Filesystem Utilization","expr":"(sum(node_filesystem_size{device!=\"rootfs\"}) - sum(node_filesystem_free{device!=\"rootfs\"})) / sum(node_filesystem_size{device!=\"rootfs\"})"},
{"title":"Pod Utilization","expr":"100 - (sum(kube_node_status_capacity_pods) - sum(kube_pod_info)) / sum(kube_node_status_capacity_pods) * 100"},
{"title":"API Servers UP","expr":"(sum(up{job=\"apiserver\"} == 1) / sum(up{job=\"apiserver\"})) * 100"},
{"title":"Controller Managers UP","expr":"(sum(up{job=\"kube-controller-manager\"} == 1) / sum(up{job=\"kube-controller-manager\"})) * 100"},
{"title":"Schedulers UP","expr":"(sum(up{job=\"kube-scheduler\"} == 1) / sum(up{job=\"kube-scheduler\"})) * 100"},
{"title":"API Server Request Error Rate","expr":"max(sum by(instance) (rate(apiserver_request_count{code=~\"5..\"}[5m])) / sum by(instance) (rate(apiserver_request_count[5m]))) * 100"},
{"title":"API Server Request Latency","expr":"sum by(verb) (rate(apiserver_latency_seconds:quantile[5m]) >= 0)"},
{"title":"End to End Scheduling Latency","expr":"cluster:scheduler_e2e_scheduling_latency_seconds:quantile"},
{"title":"API Server Request Rates","expr":"sum by(instance) (rate(apiserver_request_count{code!~\"2..\"}[5m]))"},
{"title":"API Server Request Rates","expr":"sum by(instance) (rate(apiserver_request_count[5m]))"},
{"title":"CPU Cores","expr":"min(sum(kube_node_status_allocatable_cpu_cores) by (instance))"},
{"title":"CPU Cores","expr":"max(sum(kube_pod_container_resource_requests_cpu_cores) by (instance))"},
{"title":"CPU Cores","expr":"max(sum(kube_pod_container_resource_requests_cpu_cores) by (instance)) / min(sum(kube_node_status_allocatable_cpu_cores) by (instance)) * 100"},
{"title":"Memory","expr":"min(sum(kube_node_status_allocatable_memory_bytes) by (instance))"},
{"title":"Memory","expr":"max(sum(kube_pod_container_resource_requests_memory_bytes) by (instance))"},
{"title":"Memory","expr":"max(sum(kube_pod_container_resource_requests_memory_bytes) by (instance)) / min(sum(kube_node_status_allocatable_memory_bytes) by (instance)) * 100"},
{"title":"Idle CPU","expr":"100 - (avg by (cpu) (irate(node_cpu{mode=\"idle\", instance=\"$server\"}[5m])) * 100)"},
{"title":"System Load","expr":"node_load1{instance=\"$server\"}"},
{"title":"System Load","expr":"node_load5{instance=\"$server\"}"},
{"title":"System Load","expr":"node_load15{instance=\"$server\"}"},
{"title":"Memory Usage","expr":"node_memory_MemTotal{instance=\"$server\"} - node_memory_MemFree{instance=\"$server\"} - node_memory_Buffers{instance=\"$server\"} - node_memory_Cached{instance=\"$server\"}"},
{"title":"Memory Usage","expr":"node_memory_Buffers{instance=\"$server\"}"},
{"title":"Memory Usage","expr":"node_memory_Cached{instance=\"$server\"}"},
{"title":"Memory Usage","expr":"node_memory_MemFree{instance=\"$server\"}"},
{"title":"Memory Usage","expr":"((node_memory_MemTotal{instance=\"$server\"} - node_memory_MemFree{instance=\"$server\"}  - node_memory_Buffers{instance=\"$server\"} - node_memory_Cached{instance=\"$server\"}) / node_memory_MemTotal{instance=\"$server\"}) * 100"},
{"title":"Disk I/O","expr":"sum by (instance) (rate(node_disk_bytes_read{instance=\"$server\"}[2m]))"},
{"title":"Disk I/O","expr":"sum by (instance) (rate(node_disk_bytes_written{instance=\"$server\"}[2m]))"},
{"title":"Disk I/O","expr":"sum by (instance) (rate(node_disk_io_time_ms{instance=\"$server\"}[2m]))"},
{"title":"Disk Space Usage","expr":"(sum(node_filesystem_size{device!=\"rootfs\",instance=\"$server\"}) - sum(node_filesystem_free{device!=\"rootfs\",instance=\"$server\"})) / sum(node_filesystem_size{device!=\"rootfs\",instance=\"$server\"})"},
{"title":"Network Received","expr":"rate(node_network_receive_bytes{instance=\"$server\",device!~\"lo\"}[5m])"},
{"title":"Network Transmitted","expr":"rate(node_network_transmit_bytes{instance=\"$server\",device!~\"lo\"}[5m])"},
{"title":"Memory Usage","expr":"sum by(container_name) (container_memory_usage_bytes{pod_name=\"$pod\", container_name=~\"$container\", container_name!=\"POD\"})"},
{"title":"Memory Usage","expr":"kube_pod_container_resource_requests_memory_bytes{pod=\"$pod\", container=~\"$container\"}"},
{"title":"Memory Usage","expr":"kube_pod_container_resource_limits_memory_bytes{pod=\"$pod\", container=~\"$container\"}"},
{"title":"CPU Usage","expr":"sum by (container_name)(rate(container_cpu_usage_seconds_total{image!=\"\",container_name!=\"POD\",pod_name=\"$pod\"}[1m]))"},
{"title":"CPU Usage","expr":"kube_pod_container_resource_requests_cpu_cores{pod=\"$pod\", container=~\"$container\"}"},
{"title":"CPU Usage","expr":"kube_pod_container_resource_limits_cpu_cores{pod=\"$pod\", container=~\"$container\"}"},
{"title":"Network I/O","expr":"sort_desc(sum by (pod_name) (rate(container_network_receive_bytes_total{pod_name=\"$pod\"}[1m])))"},
{"title":"CPU","expr":"sum(rate(container_cpu_usage_seconds_total{namespace=\"$statefulset_namespace\",pod_name=~\"$statefulset_name.*\"}[3m]))"},
{"title":"Memory","expr":"sum(container_memory_usage_bytes{namespace=\"$statefulset_namespace\",pod_name=~\"$statefulset_name.*\"}) / 1024^3"},
{"title":"Network","expr":"sum(rate(container_network_transmit_bytes_total{namespace=\"$statefulset_namespace\",pod_name=~\"$statefulset_name.*\"}[3m])) + sum(rate(container_network_receive_bytes_total{namespace=\"$statefulset_namespace\",pod_name=~\"$statefulset_name.*\"}[3m]))"},
{"title":"Desired Replicas","expr":"max(kube_statefulset_replicas{statefulset=\"$statefulset_name\",namespace=\"$statefulset_namespace\"}) without (instance, pod)"},
{"title":"Available Replicas","expr":"min(kube_statefulset_status_replicas{statefulset=\"$statefulset_name\",namespace=\"$statefulset_namespace\"}) without (instance, pod)"},
{"title":"Observed Generation","expr":"max(kube_statefulset_status_observed_generation{statefulset=\"$statefulset_name\",namespace=\"$statefulset_namespace\"}) without (instance, pod)"},
{"title":"Metadata Generation","expr":"max(kube_statefulset_metadata_generation{statefulset=\"$statefulset_name\",namespace=\"$statefulset_namespace\"}) without (instance, pod)"},
{"title":"Replicas","expr":"min(kube_statefulset_status_replicas{statefulset=\"$statefulset_name\",namespace=\"$statefulset_namespace\"}) without (instance, pod)"},
{"title":"Replicas","expr":"max(kube_statefulset_replicas{statefulset=\"$statefulset_name\",namespace=\"$statefulset_namespace\"}) without (instance, pod)"}
]
